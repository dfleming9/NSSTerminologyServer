$headers = New-Object "System.Collections.Generic.Dictionary[[String],[String]]"
$headers.Add("Authorization", "Bearer <token>")

$body = "{
`n    `"resourceType`": `"Parameters`",
`n    `"parameter`": [ontology.scot.nhs.uk
`n        {
`n            `"name`": `"valueSet`",
`n            `"resource`": {
`n                `"resourceType`": `"ValueSet`",
`n                `"compose`": {
`n                    `"include`": [
`n                        {
`n                            `"system`": `"https://dmd.nhs.uk`",
`n                            `"filter`": [
`n                                {
`n                                    `"property`": `"CATCD`",
`n                                    `"op`": `"=`",
`n                                    `"value`": `"2`"
`n                                },
`n                                {
`n                                    `"property`": `"parent`",
`n                                    `"op`": `"=`",
`n                                    `"value`": `"VMP`"
`n                                }
`n                            ]
`n                        }
`n                    ]
`n                }
`n            }
`n        },
`n        {
`n            `"name`": `"count`",
`n            `"valueInteger`": 100
`n        },
`n        {
`n            `"name`": `"filter`",
`n            `"valueString`": `"morphine`"
`n        },
`n        {
`n            `"name`": `"property`",
`n            `"valueString`": `"CATCD`"
`n        },
`n        {
`n            `"name`": `"property`",
`n            `"valueString`": `"parent`"
`n        },
`n        {
`n            `"name`": `"property`",
`n            `"valueString`": `"ROUTECD`"
`n        },
`n        {
`n            `"name`": `"property`",
`n            `"valueString`": `"FORMCD`"
`n        }
`n    ]
`n}"

$response = Invoke-RestMethod 'https://ontology.nhs.uk/production1/fhir/ValueSet/$expand' -Method 'POST' -Headers $headers -Body $body
$response | ConvertTo-Json